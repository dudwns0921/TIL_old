# 프로세스 관리

# 1. 개념 및 유형

# 1-1. 데몬

리눅스 시스템이 부팅 시 자동으로 실행되는 백그라운드 프로세스

| 이름       | 설명                                                         |
| ---------- | ------------------------------------------------------------ |
| standalone | 독립적으로 수행되며 서비스 요청에 응답하기 위해 항상 메모리에 상주하는 데몬<br />ex) httpd |
| inted      | 필요한 서비스이나 자주 사용하지 않는 서비스들을 관리할 때 유용한 방법으로 특히 메모리 관리에 효율적<br />보안상의 이유로 리눅스 커널 2.4버전부터 xinetd가 inetd의 역할을 대신한다.<br />ex) telnet, pop3, finger |
| inted 타입 | 직접 서비스를 가동하지 못하고 inetd 데몬이 활성화되어야만 해당 서비스 제공 |



# 1-2. fork()와 exec()

하나의 프로세스가 다른 프로세스를 실행하기 위해 fork와 exec를 사용한다.

- exec() : 시스템 호출 함수로 호출하는 프로세스가 새로운 프로세스로 변경되는 방식
- fork() : 시스템 호출 함수로 기존 프로세스를 복제하는 방식



# 1-3. NI 값

NI 번호는 관리자와 사용자가 조작할 수 있는 우선순위 값이다.

NI값의 범위 : -20 ~ 19

-20은 가장 높은 우선권을 가지며 19는 가장 낮은 우선권을 가짐

일반 사용자는 NI 값을 증가시키는 것만 가능 , root 사용자만 NI 값을 감소시킬 수 있음



# 1-4. 시그널 번호

| 번호 | 시그널  | 발생 조건             | 기본 동작            |
| ---- | ------- | --------------------- | -------------------- |
| 2    | SIGINT  | 컨트롤 + c            | 종료                 |
| 9    | SIGKILL | 프로세스 강제 종료 시 | 종료                 |
| 15   | SIGTERM | kill 시스템 호출 시   | 종료                 |
| 20   | SIGTSTP | 컨트롤 + z            | 프로세스 대기로 전환 |



## :bulb:Tip!

- nfs 구동 방법 : /etc/rc.d/init.d/nfs start
- pstree -h : fork()에 의해 생성된 부모 프로세스와 자식 프로세스의 관계를 확인 가능
- suspend : 시스템 일시적으로 중지



# 2. 프로세스 유틸리티

# 2-1. ps

- 실행 중인 프로세스를 보여줌
- 옵션

-a : 현재 실행 중인 모든 프로세스 출력

-u : 사용자 이름과 프로세스 시간 출력

-x : 접속된 터미널뿐만 아니라 사용되고 있는 모든 프로세스들 출력

- ps aux : 현재 시스템 사용자가 사용하고 있는 프로세스의 모든 정보를 확인할 수 있음
- 상태

-USER : 프로세스 소유자

-RSS : 실제 사용되는 메모리량

-TTY : 프로세스와 연결된 터미널 번호

- STAT  값

-S : 특정 이벤트가 끝나기를 기다리는 상태

-Z : 작업이 종료되었으나 부모 프로세스로부터 회수되지 않아 메모리를 차지하고 있는 상태

-R : 실행 중 혹은 실행될 수 있는 상태

-T : 정지된 상태

-D : 디스크 I/O에 의해 대기하고 있는 상태



# 2-2. pstree

- 실행 중인 프로세스들을 트리 구조로 나타냄

- 옵션

-p : 프로세스 ID 표시

-a : 명령행 인자를 포함한 정보를 트리구조에 표시

-h : 현재 프로세스와 해당 프로세스의 부모 프로세스를 음영으로 강조해서 출력



# 2-3. jobs

- 작업이 중지된 상태, 백그라운드로 진행 중인 상태, 변경되었지만 보고되지 않은 상태 등을 표시
- 출력된 목록 중에서 기호 '-'는 대기 상태 작업을 나타냄



# 2-4. bg와 fg

- 포어그라운드에서 백그라운드로의 전환
- 명령어 뒤에 &를 붙여주면 백그라운드로 작업
- 컨트롤 + C 포어그라운드 작업 종료
- 포어그라운드에서 백그라운드로 전환 : 먼저 실행 중인 작업을 일시 중지시킨 후 bg 명령어 실행



# 2-5. kill

- 프로세스를 종료시킴
- 옵션

-ㅣ : 시그널 종류 나열

-1 : 프로세스 재시작

-9 : 프로세스 강제종료



# 2-6. kill all

- 같은 데몬의 여러 프로세서를 한 번에 종료



# 2-7. nice

- 프로세스 사이의 우선순위를 확인하고 우선순위를 변경할 수 있는 명령
- NI 범위 : -20 ~ 19
- 옵션

-숫자 : 사용하지 않으면 디폴트 10



# 2-8. renice

- 이미 실행 중인 프로세스의 우선순위를 변경
- 기존 NI 값에 상관없이 NI 값을 설정



# 2-9. top

- 리눅스 시스템의 운영 상태를 실시간으로 모니터링, 프로세스 상태 확인
- 옵션

-k : kill과 동일

-n : 표시되는 프로세스 개수 지정

-i : 좀비 프로세스나 idle 프로세스의 정보 출력 제어

-r : NI 값  

-s : 화면 갱신시간 변경

-q : top 종료

- 실행 상태에서 t 키를 입력하면 명령어 라인 항목으로 on / off 할 수 있음



# 2-10. nohup

- 프로세스가 중단되지 않고 백그라운드로 작업을 수행할 수 있게 한다
- 실행 중인 프로세스의 터미널이 닫히더라도 작업을 계속 수행



# 2-11. tail

- 마지막 행을 기준으로 지정한 행까지 파일 내용의 일부 출력
- 조작 키

컨트롤 + d : 진행 중인 작업 정상 종료 또는 shell 상태면 로그아웃

컨트롤 + c : 진행 중인 작업 취소

컨트롤 + z : 프로세스 대기



# 2-12. cron

- 주기적으로 반복되는 일을 자동적으로 실행
- 스케줄링 데몬(서비스)는 crond이며 관련 파일은 /etc/crontab이다.
- 옵션

-e : crontab을 작성하거나 수정

-u : 특정 사용자의 일정 수정

